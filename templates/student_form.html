{% extends "base.html" %}
{% block content %}
<div class="max-w-2xl">
  <form method="post" class="bg-white p-6 rounded shadow">
    <h2 class="text-xl font-semibold mb-4">{{ action }} Student</h2>
    <label class="block mb-2">Name
      <input name="name" value="{{ student.name if student else '' }}" class="mt-1 w-full border rounded p-2" required>
    </label>
    <label class="block mb-2">Class
      <input name="class" value="{{ student.class if student else '' }}" class="mt-1 w-full border rounded p-2" required>
    </label>
    <label class="block mb-2">Contact
      <input name="contact" value="{{ student.contact if student else '' }}" class="mt-1 w-full border rounded p-2">
    </label>
    <label class="block mb-4">Total Fee (₹)
      <input name="total_fee" type="number" step="0.01" value="{{ student.total_fee if student else 0 }}" class="mt-1 w-full border rounded p-2" required>
    </label>

    <div class="flex gap-2">
      <button class="bg-indigo-600 text-white px-4 py-2 rounded">{{ action }}</button>
      <a href="{{ url_for('students_list') }}" class="px-4 py-2 border rounded">Cancel</a>
    </div>
  </form>

  {% if student %}
  <div class="bg-white p-4 mt-4 rounded shadow">
    <h3 class="font-semibold">Payments</h3>
    <form method="post" action="{{ url_for('add_payment', sid=student._id) }}" class="mt-3 flex gap-2">
      <input name="amount" type="number" step="0.01" placeholder="Amount" class="border p-2 rounded" required>
      <input name="note" placeholder="Note (optional)" class="border p-2 rounded">
      <button class="bg-green-600 text-white px-3 py-1 rounded">Add Payment</button>
    </form>

    <ul class="mt-3">
      {% for p in student.payments %}
        <li class="text-sm">{{ p.date }} — ₹{{ p.amount }} {% if p.note %}• {{ p.note }}{% endif %}</li>
      {% else %}
        <li class="text-sm text-gray-500">No payments yet.</li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}
</div>
{% endblock %}
